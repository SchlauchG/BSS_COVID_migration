* Prepare dataset for randomized inference test
clear all
macro drop _all

global dirpath "/Users/garyschlauch/desktop/covid_india_migrants"
global dirpath_in = "$dirpath/data/generated/final/regression_inputs"
global dirpath_out = "$dirpath/data/Generated/Final/Results"

* Tempfile for collecting betahats
tempfile all_betas
save `all_betas', emptyok

* Get phase2 and non-phase2 migrant counts
use "$dirpath_in/covid19india_migrants_remittance.dta", clear
duplicates drop state district, force
keep if in_state == 1
replace T5m_Dremittance = round(T5m_Dremittance)
rename T5m_Dremittance num_migrants

collapse (sum) num_migrants, by(phase2)
sort phase2

local phase2_migrants_remittance = num_migrants[2]
local phase3_migrants_remittance = num_migrants[1]

clear

* Load dataset
use "$dirpath_in/event_study_dataset_permtest.dta", clear

* Run regression using actual cases data
qui areg num_cases Tmig_phase1* Tmig_phase2* Tmig_phase3* ///
	num_cases_date_control num_tested_1wk week week2, ///
	absorb(district_id) vce(cluster district_id)
	
qui lincom((((((Tmig_phase2_128 - Tmig_phase1_128) + (Tmig_phase2_129 - Tmig_phase1_129) + (Tmig_phase2_130 - Tmig_phase1_130) + (Tmig_phase2_131 - Tmig_phase1_131) + (Tmig_phase2_132 - Tmig_phase1_132) + (Tmig_phase2_133 - Tmig_phase1_133) + (Tmig_phase2_134 - Tmig_phase1_134) + (Tmig_phase2_135 - Tmig_phase1_135) + (Tmig_phase2_136 - Tmig_phase1_136) + (Tmig_phase2_137 - Tmig_phase1_137) + (Tmig_phase2_138 - Tmig_phase1_138) + (Tmig_phase2_139 - Tmig_phase1_139) + (Tmig_phase2_140 - Tmig_phase1_140) + (Tmig_phase2_141 - Tmig_phase1_141) + (Tmig_phase2_142 - Tmig_phase1_142) + (Tmig_phase2_143 - Tmig_phase1_143) + (Tmig_phase2_144 - Tmig_phase1_144) + (Tmig_phase2_145 - Tmig_phase1_145) + (Tmig_phase2_146 - Tmig_phase1_146) + (Tmig_phase2_147 - Tmig_phase1_147) + (Tmig_phase2_148 - Tmig_phase1_148) + (Tmig_phase2_149 - Tmig_phase1_149) + (Tmig_phase2_150 - Tmig_phase1_150) + (Tmig_phase2_151 - Tmig_phase1_151) + (Tmig_phase2_152 - Tmig_phase1_152) + (Tmig_phase2_153 - Tmig_phase1_153) + (Tmig_phase2_154 - Tmig_phase1_154) + (Tmig_phase2_155 - Tmig_phase1_155) + (Tmig_phase2_156 - Tmig_phase1_156) + (Tmig_phase2_157 - Tmig_phase1_157) + (Tmig_phase2_158 - Tmig_phase1_158) + (Tmig_phase2_159 - Tmig_phase1_159) + (Tmig_phase2_160 - Tmig_phase1_160) + (Tmig_phase2_161 - Tmig_phase1_161) + (Tmig_phase2_162 - Tmig_phase1_162) + (Tmig_phase2_163 - Tmig_phase1_163) + (Tmig_phase2_164 - Tmig_phase1_164) + (Tmig_phase2_165 - Tmig_phase1_165) + (Tmig_phase2_166 - Tmig_phase1_166) + (Tmig_phase2_167 - Tmig_phase1_167) + (Tmig_phase2_168 - Tmig_phase1_168) + (Tmig_phase2_169 - Tmig_phase1_169) + (Tmig_phase2_170 - Tmig_phase1_170) + (Tmig_phase2_171 - Tmig_phase1_171) + (Tmig_phase2_172 - Tmig_phase1_172) + (Tmig_phase2_173 - Tmig_phase1_173) + (Tmig_phase2_174 - Tmig_phase1_174) + (Tmig_phase2_175 - Tmig_phase1_175) + (Tmig_phase2_176 - Tmig_phase1_176) + (Tmig_phase2_177 - Tmig_phase1_177) + (Tmig_phase2_178 - Tmig_phase1_178) + (Tmig_phase2_179 - Tmig_phase1_179) + (Tmig_phase2_180 - Tmig_phase1_180) + (Tmig_phase2_181 - Tmig_phase1_181) + (Tmig_phase2_182 - Tmig_phase1_182) + (Tmig_phase2_183 - Tmig_phase1_183) + (Tmig_phase2_184 - Tmig_phase1_184) + (Tmig_phase2_185 - Tmig_phase1_185) + (Tmig_phase2_186 - Tmig_phase1_186) + (Tmig_phase2_187 - Tmig_phase1_187) + (Tmig_phase2_188 - Tmig_phase1_188) + (Tmig_phase2_189 - Tmig_phase1_189) + (Tmig_phase2_190 - Tmig_phase1_190) + (Tmig_phase2_191 - Tmig_phase1_191) + (Tmig_phase2_192 - Tmig_phase1_192) + (Tmig_phase2_193 - Tmig_phase1_193) + (Tmig_phase2_194 - Tmig_phase1_194) + (Tmig_phase2_195 - Tmig_phase1_195) + (Tmig_phase2_196 - Tmig_phase1_196) + (Tmig_phase2_197 - Tmig_phase1_197) + (Tmig_phase2_198 - Tmig_phase1_198) + (Tmig_phase2_199 - Tmig_phase1_199) + (Tmig_phase2_200 - Tmig_phase1_200) + (Tmig_phase2_201 - Tmig_phase1_201) + (Tmig_phase2_202 - Tmig_phase1_202) + (Tmig_phase2_203 - Tmig_phase1_203) + (Tmig_phase2_204 - Tmig_phase1_204) + (Tmig_phase2_205 - Tmig_phase1_205) + (Tmig_phase2_206 - Tmig_phase1_206) + (Tmig_phase2_207 - Tmig_phase1_207) + (Tmig_phase2_208 - Tmig_phase1_208) + (Tmig_phase2_209 - Tmig_phase1_209) + (Tmig_phase2_210 - Tmig_phase1_210) + (Tmig_phase2_211 - Tmig_phase1_211) + (Tmig_phase2_212 - Tmig_phase1_212) + (Tmig_phase2_213 - Tmig_phase1_213) + (Tmig_phase2_214 - Tmig_phase1_214) + (Tmig_phase2_215 - Tmig_phase1_215) + (Tmig_phase2_216 - Tmig_phase1_216) + (Tmig_phase2_217 - Tmig_phase1_217) + (Tmig_phase2_218 - Tmig_phase1_218) + (Tmig_phase2_219 - Tmig_phase1_219) + (Tmig_phase2_220 - Tmig_phase1_220) + (Tmig_phase2_221 - Tmig_phase1_221) + (Tmig_phase2_222 - Tmig_phase1_222) + (Tmig_phase2_223 - Tmig_phase1_223) + (Tmig_phase2_224 - Tmig_phase1_224) + (Tmig_phase2_225 - Tmig_phase1_225) + (Tmig_phase2_226 - Tmig_phase1_226) + (Tmig_phase2_227 - Tmig_phase1_227) + (Tmig_phase2_228 - Tmig_phase1_228) + (Tmig_phase2_229 - Tmig_phase1_229) + ((Tmig_phase2_230 - Tmig_phase1_230)*16)) - (((Tmig_phase2_77 - Tmig_phase1_77)*45) + (Tmig_phase2_78 - Tmig_phase1_78) + (Tmig_phase2_79 - Tmig_phase1_79) + (Tmig_phase2_80 - Tmig_phase1_80) + (Tmig_phase2_81 - Tmig_phase1_81) + (Tmig_phase2_82 - Tmig_phase1_82) + (Tmig_phase2_83 - Tmig_phase1_83) + (Tmig_phase2_84 - Tmig_phase1_84) + (Tmig_phase2_85 - Tmig_phase1_85) + (Tmig_phase2_86 - Tmig_phase1_86) + (Tmig_phase2_87 - Tmig_phase1_87) + (Tmig_phase2_88 - Tmig_phase1_88) + (Tmig_phase2_89 - Tmig_phase1_89) + (Tmig_phase2_90 - Tmig_phase1_90) + (Tmig_phase2_91 - Tmig_phase1_91) + (Tmig_phase2_92 - Tmig_phase1_92) + (Tmig_phase2_93 - Tmig_phase1_93) + (Tmig_phase2_94 - Tmig_phase1_94) + (Tmig_phase2_95 - Tmig_phase1_95) + (Tmig_phase2_96 - Tmig_phase1_96) + (Tmig_phase2_97 - Tmig_phase1_97) + (Tmig_phase2_98 - Tmig_phase1_98) + (Tmig_phase2_99 - Tmig_phase1_99) + (Tmig_phase2_100 - Tmig_phase1_100) + (Tmig_phase2_101 - Tmig_phase1_101) + (Tmig_phase2_102 - Tmig_phase1_102) + (Tmig_phase2_103 - Tmig_phase1_103) + (Tmig_phase2_104 - Tmig_phase1_104) + (Tmig_phase2_105 - Tmig_phase1_105) + (Tmig_phase2_106 - Tmig_phase1_106) + (Tmig_phase2_107 - Tmig_phase1_107) + (Tmig_phase2_108 - Tmig_phase1_108) + (Tmig_phase2_109 - Tmig_phase1_109) + (Tmig_phase2_110 - Tmig_phase1_110) + (Tmig_phase2_111 - Tmig_phase1_111) + (Tmig_phase2_112 - Tmig_phase1_112) + (Tmig_phase2_113 - Tmig_phase1_113) + (Tmig_phase2_114 - Tmig_phase1_114) + (Tmig_phase2_115 - Tmig_phase1_115) + (Tmig_phase2_116 - Tmig_phase1_116) + (Tmig_phase2_117 - Tmig_phase1_117) + (Tmig_phase2_118 - Tmig_phase1_118) + (Tmig_phase2_119 - Tmig_phase1_119) + (Tmig_phase2_120 - Tmig_phase1_120) + (Tmig_phase2_121 - Tmig_phase1_121) + (Tmig_phase2_122 - Tmig_phase1_122) + (Tmig_phase2_123 - Tmig_phase1_123) + (Tmig_phase2_124 - Tmig_phase1_124) + (Tmig_phase2_125 - Tmig_phase1_125) + (Tmig_phase2_126 - Tmig_phase1_126) + (Tmig_phase2_127 - Tmig_phase1_127))) * `phase2_migrants_remittance') + ///
	((((Tmig_phase3_203 - Tmig_phase1_203) + (Tmig_phase3_204 - Tmig_phase1_204) + (Tmig_phase3_205 - Tmig_phase1_205) + (Tmig_phase3_206 - Tmig_phase1_206) + (Tmig_phase3_207 - Tmig_phase1_207) + (Tmig_phase3_208 - Tmig_phase1_208) + (Tmig_phase3_209 - Tmig_phase1_209) + (Tmig_phase3_210 - Tmig_phase1_210) + (Tmig_phase3_211 - Tmig_phase1_211) + (Tmig_phase3_212 - Tmig_phase1_212) + (Tmig_phase3_213 - Tmig_phase1_213) + (Tmig_phase3_214 - Tmig_phase1_214) + (Tmig_phase3_215 - Tmig_phase1_215) + (Tmig_phase3_216 - Tmig_phase1_216) + (Tmig_phase3_217 - Tmig_phase1_217) + (Tmig_phase3_218 - Tmig_phase1_218) + (Tmig_phase3_219 - Tmig_phase1_219) + (Tmig_phase3_220 - Tmig_phase1_220) + (Tmig_phase3_221 - Tmig_phase1_221) + (Tmig_phase3_222 - Tmig_phase1_222) + (Tmig_phase3_223 - Tmig_phase1_223) + (Tmig_phase3_224 - Tmig_phase1_224) + (Tmig_phase3_225 - Tmig_phase1_225) + (Tmig_phase3_226 - Tmig_phase1_226) + (Tmig_phase3_227 - Tmig_phase1_227) + (Tmig_phase3_228 - Tmig_phase1_228) + (Tmig_phase3_229 - Tmig_phase1_229) + ((Tmig_phase3_230 - Tmig_phase1_230)*16)) - (((Tmig_phase3_77 - Tmig_phase1_77)*45) + (Tmig_phase3_78 - Tmig_phase1_78) + (Tmig_phase3_79 - Tmig_phase1_79) + (Tmig_phase3_80 - Tmig_phase1_80) + (Tmig_phase3_81 - Tmig_phase1_81) + (Tmig_phase3_82 - Tmig_phase1_82) + (Tmig_phase3_83 - Tmig_phase1_83) + (Tmig_phase3_84 - Tmig_phase1_84) + (Tmig_phase3_85 - Tmig_phase1_85) + (Tmig_phase3_86 - Tmig_phase1_86) + (Tmig_phase3_87 - Tmig_phase1_87) + (Tmig_phase3_88 - Tmig_phase1_88) + (Tmig_phase3_89 - Tmig_phase1_89) + (Tmig_phase3_90 - Tmig_phase1_90) + (Tmig_phase3_91 - Tmig_phase1_91) + (Tmig_phase3_92 - Tmig_phase1_92) + (Tmig_phase3_93 - Tmig_phase1_93) + (Tmig_phase3_94 - Tmig_phase1_94) + (Tmig_phase3_95 - Tmig_phase1_95) + (Tmig_phase3_96 - Tmig_phase1_96) + (Tmig_phase3_97 - Tmig_phase1_97) + (Tmig_phase3_98 - Tmig_phase1_98) + (Tmig_phase3_99 - Tmig_phase1_99) + (Tmig_phase3_100 - Tmig_phase1_100) + (Tmig_phase3_101 - Tmig_phase1_101) + (Tmig_phase3_102 - Tmig_phase1_102) + (Tmig_phase3_103 - Tmig_phase1_103) + (Tmig_phase3_104 - Tmig_phase1_104) + (Tmig_phase3_105 - Tmig_phase1_105) + (Tmig_phase3_106 - Tmig_phase1_106) + (Tmig_phase3_107 - Tmig_phase1_107) + (Tmig_phase3_108 - Tmig_phase1_108) + (Tmig_phase3_109 - Tmig_phase1_109) + (Tmig_phase3_110 - Tmig_phase1_110) + (Tmig_phase3_111 - Tmig_phase1_111) + (Tmig_phase3_112 - Tmig_phase1_112) + (Tmig_phase3_113 - Tmig_phase1_113) + (Tmig_phase3_114 - Tmig_phase1_114) + (Tmig_phase3_115 - Tmig_phase1_115) + (Tmig_phase3_116 - Tmig_phase1_116) + (Tmig_phase3_117 - Tmig_phase1_117) + (Tmig_phase3_118 - Tmig_phase1_118) + (Tmig_phase3_119 - Tmig_phase1_119) + (Tmig_phase3_120 - Tmig_phase1_120) + (Tmig_phase3_121 - Tmig_phase1_121) + (Tmig_phase3_122 - Tmig_phase1_122) + (Tmig_phase3_123 - Tmig_phase1_123) + (Tmig_phase3_124 - Tmig_phase1_124) + (Tmig_phase3_125 - Tmig_phase1_125) + (Tmig_phase3_126 - Tmig_phase1_126) + (Tmig_phase3_127 - Tmig_phase1_127) + (Tmig_phase3_128 - Tmig_phase1_128) + (Tmig_phase3_129 - Tmig_phase1_129) + (Tmig_phase3_130 - Tmig_phase1_130) + (Tmig_phase3_131 - Tmig_phase1_131) + (Tmig_phase3_132 - Tmig_phase1_132) + (Tmig_phase3_133 - Tmig_phase1_133) + (Tmig_phase3_134 - Tmig_phase1_134) + (Tmig_phase3_135 - Tmig_phase1_135) + (Tmig_phase3_136 - Tmig_phase1_136) + (Tmig_phase3_137 - Tmig_phase1_137) + (Tmig_phase3_138 - Tmig_phase1_138) + (Tmig_phase3_139 - Tmig_phase1_139) + (Tmig_phase3_140 - Tmig_phase1_140) + (Tmig_phase3_141 - Tmig_phase1_141) + (Tmig_phase3_142 - Tmig_phase1_142) + (Tmig_phase3_143 - Tmig_phase1_143) + (Tmig_phase3_144 - Tmig_phase1_144) + (Tmig_phase3_145 - Tmig_phase1_145) + (Tmig_phase3_146 - Tmig_phase1_146) + (Tmig_phase3_147 - Tmig_phase1_147) + (Tmig_phase3_148 - Tmig_phase1_148) + (Tmig_phase3_149 - Tmig_phase1_149) + (Tmig_phase3_150 - Tmig_phase1_150) + (Tmig_phase3_151 - Tmig_phase1_151) + (Tmig_phase3_152 - Tmig_phase1_152) + (Tmig_phase3_153 - Tmig_phase1_153) + (Tmig_phase3_154 - Tmig_phase1_154) + (Tmig_phase3_155 - Tmig_phase1_155) + (Tmig_phase3_156 - Tmig_phase1_156) + (Tmig_phase3_157 - Tmig_phase1_157) + (Tmig_phase3_158 - Tmig_phase1_158) + (Tmig_phase3_159 - Tmig_phase1_159) + (Tmig_phase3_160 - Tmig_phase1_160) + (Tmig_phase3_161 - Tmig_phase1_161) + (Tmig_phase3_162 - Tmig_phase1_162) + (Tmig_phase3_163 - Tmig_phase1_163) + (Tmig_phase3_164 - Tmig_phase1_164) + (Tmig_phase3_165 - Tmig_phase1_165) + (Tmig_phase3_166 - Tmig_phase1_166) + (Tmig_phase3_167 - Tmig_phase1_167) + (Tmig_phase3_168 - Tmig_phase1_168) + (Tmig_phase3_169 - Tmig_phase1_169) + (Tmig_phase3_170 - Tmig_phase1_170) + (Tmig_phase3_171 - Tmig_phase1_171) + (Tmig_phase3_172 - Tmig_phase1_172) + (Tmig_phase3_173 - Tmig_phase1_173) + (Tmig_phase3_174 - Tmig_phase1_174) + (Tmig_phase3_175 - Tmig_phase1_175) + (Tmig_phase3_176 - Tmig_phase1_176) + (Tmig_phase3_177 - Tmig_phase1_177) + (Tmig_phase3_178 - Tmig_phase1_178) + (Tmig_phase3_179 - Tmig_phase1_179) + (Tmig_phase3_180 - Tmig_phase1_180) + (Tmig_phase3_181 - Tmig_phase1_181) + (Tmig_phase3_182 - Tmig_phase1_182) + (Tmig_phase3_183 - Tmig_phase1_183) + (Tmig_phase3_184 - Tmig_phase1_184) + (Tmig_phase3_185 - Tmig_phase1_185) + (Tmig_phase3_186 - Tmig_phase1_186) + (Tmig_phase3_187 - Tmig_phase1_187) + (Tmig_phase3_188 - Tmig_phase1_188) + (Tmig_phase3_189 - Tmig_phase1_189) + (Tmig_phase3_190 - Tmig_phase1_190) + (Tmig_phase3_191 - Tmig_phase1_191) + (Tmig_phase3_192 - Tmig_phase1_192) + (Tmig_phase3_193 - Tmig_phase1_193) + (Tmig_phase3_194 - Tmig_phase1_194) + (Tmig_phase3_195 - Tmig_phase1_195) + (Tmig_phase3_196 - Tmig_phase1_196) + (Tmig_phase3_197 - Tmig_phase1_197) + (Tmig_phase3_198 - Tmig_phase1_198) + (Tmig_phase3_199 - Tmig_phase1_199) + (Tmig_phase3_200 - Tmig_phase1_200) + (Tmig_phase3_201 - Tmig_phase1_201) + (Tmig_phase3_202 - Tmig_phase1_202))) * `phase3_migrants_remittance')))

gen beta = r(estimate)
gen se = r(se)
gen true_beta = 1
gen seed = ""
keep beta se true_beta seed
keep in 1

append using `all_betas'
save `"`all_betas'"', replace

* Get randomzied betahats
forval i = 1/2 {
	
* Monitor loop
di "Iteration number: `i'"
	
* Set seed for each iteration
set seed `i'
		
* Load cleaned migrant data
use "$dirpath_in/covid19india_migrants_remittance.dta", clear

* Assign a random number to eacah district
keep num_cases date district_id
gen random_var = runiform()
bysort district_id (date): replace random_var = random_var[1]

* Assign a new district id based on this random number
preserve
keep district_id random_var
duplicates drop
sort random_var
gen new_district_id = _n
tempfile new_dist_id
save `new_dist_id', replace
restore

* Replace the old district id in the cases time series with the random one
qui merge m:1 district_id using `new_dist_id', nogen
drop district_id random_var
rename new_district_id district_id
rename num_cases new_num_cases

* Join onto event study dataframe, keeping only the dates that match
* since dates outside event windows were dropped
qui merge 1:m district_id date using ///
	"$dirpath_in/event_study_dataset_permtest.dta", nogen keep(3)
	
* Replace the original cases time series with one from another randomly
* assigned district
drop num_cases
rename new_num_cases num_cases

* Run regression using actual cases data
qui areg num_cases Tmig_phase2* Tmig_phase3* Tmig_phase1* ///
	num_cases_date_control num_tested_1wk week week2, ///
	absorb(district_id) vce(cluster district_id)
	
qui lincom((((((Tmig_phase2_128 - Tmig_phase1_128) + (Tmig_phase2_129 - Tmig_phase1_129) + (Tmig_phase2_130 - Tmig_phase1_130) + (Tmig_phase2_131 - Tmig_phase1_131) + (Tmig_phase2_132 - Tmig_phase1_132) + (Tmig_phase2_133 - Tmig_phase1_133) + (Tmig_phase2_134 - Tmig_phase1_134) + (Tmig_phase2_135 - Tmig_phase1_135) + (Tmig_phase2_136 - Tmig_phase1_136) + (Tmig_phase2_137 - Tmig_phase1_137) + (Tmig_phase2_138 - Tmig_phase1_138) + (Tmig_phase2_139 - Tmig_phase1_139) + (Tmig_phase2_140 - Tmig_phase1_140) + (Tmig_phase2_141 - Tmig_phase1_141) + (Tmig_phase2_142 - Tmig_phase1_142) + (Tmig_phase2_143 - Tmig_phase1_143) + (Tmig_phase2_144 - Tmig_phase1_144) + (Tmig_phase2_145 - Tmig_phase1_145) + (Tmig_phase2_146 - Tmig_phase1_146) + (Tmig_phase2_147 - Tmig_phase1_147) + (Tmig_phase2_148 - Tmig_phase1_148) + (Tmig_phase2_149 - Tmig_phase1_149) + (Tmig_phase2_150 - Tmig_phase1_150) + (Tmig_phase2_151 - Tmig_phase1_151) + (Tmig_phase2_152 - Tmig_phase1_152) + (Tmig_phase2_153 - Tmig_phase1_153) + (Tmig_phase2_154 - Tmig_phase1_154) + (Tmig_phase2_155 - Tmig_phase1_155) + (Tmig_phase2_156 - Tmig_phase1_156) + (Tmig_phase2_157 - Tmig_phase1_157) + (Tmig_phase2_158 - Tmig_phase1_158) + (Tmig_phase2_159 - Tmig_phase1_159) + (Tmig_phase2_160 - Tmig_phase1_160) + (Tmig_phase2_161 - Tmig_phase1_161) + (Tmig_phase2_162 - Tmig_phase1_162) + (Tmig_phase2_163 - Tmig_phase1_163) + (Tmig_phase2_164 - Tmig_phase1_164) + (Tmig_phase2_165 - Tmig_phase1_165) + (Tmig_phase2_166 - Tmig_phase1_166) + (Tmig_phase2_167 - Tmig_phase1_167) + (Tmig_phase2_168 - Tmig_phase1_168) + (Tmig_phase2_169 - Tmig_phase1_169) + (Tmig_phase2_170 - Tmig_phase1_170) + (Tmig_phase2_171 - Tmig_phase1_171) + (Tmig_phase2_172 - Tmig_phase1_172) + (Tmig_phase2_173 - Tmig_phase1_173) + (Tmig_phase2_174 - Tmig_phase1_174) + (Tmig_phase2_175 - Tmig_phase1_175) + (Tmig_phase2_176 - Tmig_phase1_176) + (Tmig_phase2_177 - Tmig_phase1_177) + (Tmig_phase2_178 - Tmig_phase1_178) + (Tmig_phase2_179 - Tmig_phase1_179) + (Tmig_phase2_180 - Tmig_phase1_180) + (Tmig_phase2_181 - Tmig_phase1_181) + (Tmig_phase2_182 - Tmig_phase1_182) + (Tmig_phase2_183 - Tmig_phase1_183) + (Tmig_phase2_184 - Tmig_phase1_184) + (Tmig_phase2_185 - Tmig_phase1_185) + (Tmig_phase2_186 - Tmig_phase1_186) + (Tmig_phase2_187 - Tmig_phase1_187) + (Tmig_phase2_188 - Tmig_phase1_188) + (Tmig_phase2_189 - Tmig_phase1_189) + (Tmig_phase2_190 - Tmig_phase1_190) + (Tmig_phase2_191 - Tmig_phase1_191) + (Tmig_phase2_192 - Tmig_phase1_192) + (Tmig_phase2_193 - Tmig_phase1_193) + (Tmig_phase2_194 - Tmig_phase1_194) + (Tmig_phase2_195 - Tmig_phase1_195) + (Tmig_phase2_196 - Tmig_phase1_196) + (Tmig_phase2_197 - Tmig_phase1_197) + (Tmig_phase2_198 - Tmig_phase1_198) + (Tmig_phase2_199 - Tmig_phase1_199) + (Tmig_phase2_200 - Tmig_phase1_200) + (Tmig_phase2_201 - Tmig_phase1_201) + (Tmig_phase2_202 - Tmig_phase1_202) + (Tmig_phase2_203 - Tmig_phase1_203) + (Tmig_phase2_204 - Tmig_phase1_204) + (Tmig_phase2_205 - Tmig_phase1_205) + (Tmig_phase2_206 - Tmig_phase1_206) + (Tmig_phase2_207 - Tmig_phase1_207) + (Tmig_phase2_208 - Tmig_phase1_208) + (Tmig_phase2_209 - Tmig_phase1_209) + (Tmig_phase2_210 - Tmig_phase1_210) + (Tmig_phase2_211 - Tmig_phase1_211) + (Tmig_phase2_212 - Tmig_phase1_212) + (Tmig_phase2_213 - Tmig_phase1_213) + (Tmig_phase2_214 - Tmig_phase1_214) + (Tmig_phase2_215 - Tmig_phase1_215) + (Tmig_phase2_216 - Tmig_phase1_216) + (Tmig_phase2_217 - Tmig_phase1_217) + (Tmig_phase2_218 - Tmig_phase1_218) + (Tmig_phase2_219 - Tmig_phase1_219) + (Tmig_phase2_220 - Tmig_phase1_220) + (Tmig_phase2_221 - Tmig_phase1_221) + (Tmig_phase2_222 - Tmig_phase1_222) + (Tmig_phase2_223 - Tmig_phase1_223) + (Tmig_phase2_224 - Tmig_phase1_224) + (Tmig_phase2_225 - Tmig_phase1_225) + (Tmig_phase2_226 - Tmig_phase1_226) + (Tmig_phase2_227 - Tmig_phase1_227) + (Tmig_phase2_228 - Tmig_phase1_228) + (Tmig_phase2_229 - Tmig_phase1_229) + ((Tmig_phase2_230 - Tmig_phase1_230)*16)) - (((Tmig_phase2_77 - Tmig_phase1_77)*45) + (Tmig_phase2_78 - Tmig_phase1_78) + (Tmig_phase2_79 - Tmig_phase1_79) + (Tmig_phase2_80 - Tmig_phase1_80) + (Tmig_phase2_81 - Tmig_phase1_81) + (Tmig_phase2_82 - Tmig_phase1_82) + (Tmig_phase2_83 - Tmig_phase1_83) + (Tmig_phase2_84 - Tmig_phase1_84) + (Tmig_phase2_85 - Tmig_phase1_85) + (Tmig_phase2_86 - Tmig_phase1_86) + (Tmig_phase2_87 - Tmig_phase1_87) + (Tmig_phase2_88 - Tmig_phase1_88) + (Tmig_phase2_89 - Tmig_phase1_89) + (Tmig_phase2_90 - Tmig_phase1_90) + (Tmig_phase2_91 - Tmig_phase1_91) + (Tmig_phase2_92 - Tmig_phase1_92) + (Tmig_phase2_93 - Tmig_phase1_93) + (Tmig_phase2_94 - Tmig_phase1_94) + (Tmig_phase2_95 - Tmig_phase1_95) + (Tmig_phase2_96 - Tmig_phase1_96) + (Tmig_phase2_97 - Tmig_phase1_97) + (Tmig_phase2_98 - Tmig_phase1_98) + (Tmig_phase2_99 - Tmig_phase1_99) + (Tmig_phase2_100 - Tmig_phase1_100) + (Tmig_phase2_101 - Tmig_phase1_101) + (Tmig_phase2_102 - Tmig_phase1_102) + (Tmig_phase2_103 - Tmig_phase1_103) + (Tmig_phase2_104 - Tmig_phase1_104) + (Tmig_phase2_105 - Tmig_phase1_105) + (Tmig_phase2_106 - Tmig_phase1_106) + (Tmig_phase2_107 - Tmig_phase1_107) + (Tmig_phase2_108 - Tmig_phase1_108) + (Tmig_phase2_109 - Tmig_phase1_109) + (Tmig_phase2_110 - Tmig_phase1_110) + (Tmig_phase2_111 - Tmig_phase1_111) + (Tmig_phase2_112 - Tmig_phase1_112) + (Tmig_phase2_113 - Tmig_phase1_113) + (Tmig_phase2_114 - Tmig_phase1_114) + (Tmig_phase2_115 - Tmig_phase1_115) + (Tmig_phase2_116 - Tmig_phase1_116) + (Tmig_phase2_117 - Tmig_phase1_117) + (Tmig_phase2_118 - Tmig_phase1_118) + (Tmig_phase2_119 - Tmig_phase1_119) + (Tmig_phase2_120 - Tmig_phase1_120) + (Tmig_phase2_121 - Tmig_phase1_121) + (Tmig_phase2_122 - Tmig_phase1_122) + (Tmig_phase2_123 - Tmig_phase1_123) + (Tmig_phase2_124 - Tmig_phase1_124) + (Tmig_phase2_125 - Tmig_phase1_125) + (Tmig_phase2_126 - Tmig_phase1_126) + (Tmig_phase2_127 - Tmig_phase1_127))) * `phase2_migrants_remittance') + ///
	((((Tmig_phase3_203 - Tmig_phase1_203) + (Tmig_phase3_204 - Tmig_phase1_204) + (Tmig_phase3_205 - Tmig_phase1_205) + (Tmig_phase3_206 - Tmig_phase1_206) + (Tmig_phase3_207 - Tmig_phase1_207) + (Tmig_phase3_208 - Tmig_phase1_208) + (Tmig_phase3_209 - Tmig_phase1_209) + (Tmig_phase3_210 - Tmig_phase1_210) + (Tmig_phase3_211 - Tmig_phase1_211) + (Tmig_phase3_212 - Tmig_phase1_212) + (Tmig_phase3_213 - Tmig_phase1_213) + (Tmig_phase3_214 - Tmig_phase1_214) + (Tmig_phase3_215 - Tmig_phase1_215) + (Tmig_phase3_216 - Tmig_phase1_216) + (Tmig_phase3_217 - Tmig_phase1_217) + (Tmig_phase3_218 - Tmig_phase1_218) + (Tmig_phase3_219 - Tmig_phase1_219) + (Tmig_phase3_220 - Tmig_phase1_220) + (Tmig_phase3_221 - Tmig_phase1_221) + (Tmig_phase3_222 - Tmig_phase1_222) + (Tmig_phase3_223 - Tmig_phase1_223) + (Tmig_phase3_224 - Tmig_phase1_224) + (Tmig_phase3_225 - Tmig_phase1_225) + (Tmig_phase3_226 - Tmig_phase1_226) + (Tmig_phase3_227 - Tmig_phase1_227) + (Tmig_phase3_228 - Tmig_phase1_228) + (Tmig_phase3_229 - Tmig_phase1_229) + ((Tmig_phase3_230 - Tmig_phase1_230)*16)) - (((Tmig_phase3_77 - Tmig_phase1_77)*45) + (Tmig_phase3_78 - Tmig_phase1_78) + (Tmig_phase3_79 - Tmig_phase1_79) + (Tmig_phase3_80 - Tmig_phase1_80) + (Tmig_phase3_81 - Tmig_phase1_81) + (Tmig_phase3_82 - Tmig_phase1_82) + (Tmig_phase3_83 - Tmig_phase1_83) + (Tmig_phase3_84 - Tmig_phase1_84) + (Tmig_phase3_85 - Tmig_phase1_85) + (Tmig_phase3_86 - Tmig_phase1_86) + (Tmig_phase3_87 - Tmig_phase1_87) + (Tmig_phase3_88 - Tmig_phase1_88) + (Tmig_phase3_89 - Tmig_phase1_89) + (Tmig_phase3_90 - Tmig_phase1_90) + (Tmig_phase3_91 - Tmig_phase1_91) + (Tmig_phase3_92 - Tmig_phase1_92) + (Tmig_phase3_93 - Tmig_phase1_93) + (Tmig_phase3_94 - Tmig_phase1_94) + (Tmig_phase3_95 - Tmig_phase1_95) + (Tmig_phase3_96 - Tmig_phase1_96) + (Tmig_phase3_97 - Tmig_phase1_97) + (Tmig_phase3_98 - Tmig_phase1_98) + (Tmig_phase3_99 - Tmig_phase1_99) + (Tmig_phase3_100 - Tmig_phase1_100) + (Tmig_phase3_101 - Tmig_phase1_101) + (Tmig_phase3_102 - Tmig_phase1_102) + (Tmig_phase3_103 - Tmig_phase1_103) + (Tmig_phase3_104 - Tmig_phase1_104) + (Tmig_phase3_105 - Tmig_phase1_105) + (Tmig_phase3_106 - Tmig_phase1_106) + (Tmig_phase3_107 - Tmig_phase1_107) + (Tmig_phase3_108 - Tmig_phase1_108) + (Tmig_phase3_109 - Tmig_phase1_109) + (Tmig_phase3_110 - Tmig_phase1_110) + (Tmig_phase3_111 - Tmig_phase1_111) + (Tmig_phase3_112 - Tmig_phase1_112) + (Tmig_phase3_113 - Tmig_phase1_113) + (Tmig_phase3_114 - Tmig_phase1_114) + (Tmig_phase3_115 - Tmig_phase1_115) + (Tmig_phase3_116 - Tmig_phase1_116) + (Tmig_phase3_117 - Tmig_phase1_117) + (Tmig_phase3_118 - Tmig_phase1_118) + (Tmig_phase3_119 - Tmig_phase1_119) + (Tmig_phase3_120 - Tmig_phase1_120) + (Tmig_phase3_121 - Tmig_phase1_121) + (Tmig_phase3_122 - Tmig_phase1_122) + (Tmig_phase3_123 - Tmig_phase1_123) + (Tmig_phase3_124 - Tmig_phase1_124) + (Tmig_phase3_125 - Tmig_phase1_125) + (Tmig_phase3_126 - Tmig_phase1_126) + (Tmig_phase3_127 - Tmig_phase1_127) + (Tmig_phase3_128 - Tmig_phase1_128) + (Tmig_phase3_129 - Tmig_phase1_129) + (Tmig_phase3_130 - Tmig_phase1_130) + (Tmig_phase3_131 - Tmig_phase1_131) + (Tmig_phase3_132 - Tmig_phase1_132) + (Tmig_phase3_133 - Tmig_phase1_133) + (Tmig_phase3_134 - Tmig_phase1_134) + (Tmig_phase3_135 - Tmig_phase1_135) + (Tmig_phase3_136 - Tmig_phase1_136) + (Tmig_phase3_137 - Tmig_phase1_137) + (Tmig_phase3_138 - Tmig_phase1_138) + (Tmig_phase3_139 - Tmig_phase1_139) + (Tmig_phase3_140 - Tmig_phase1_140) + (Tmig_phase3_141 - Tmig_phase1_141) + (Tmig_phase3_142 - Tmig_phase1_142) + (Tmig_phase3_143 - Tmig_phase1_143) + (Tmig_phase3_144 - Tmig_phase1_144) + (Tmig_phase3_145 - Tmig_phase1_145) + (Tmig_phase3_146 - Tmig_phase1_146) + (Tmig_phase3_147 - Tmig_phase1_147) + (Tmig_phase3_148 - Tmig_phase1_148) + (Tmig_phase3_149 - Tmig_phase1_149) + (Tmig_phase3_150 - Tmig_phase1_150) + (Tmig_phase3_151 - Tmig_phase1_151) + (Tmig_phase3_152 - Tmig_phase1_152) + (Tmig_phase3_153 - Tmig_phase1_153) + (Tmig_phase3_154 - Tmig_phase1_154) + (Tmig_phase3_155 - Tmig_phase1_155) + (Tmig_phase3_156 - Tmig_phase1_156) + (Tmig_phase3_157 - Tmig_phase1_157) + (Tmig_phase3_158 - Tmig_phase1_158) + (Tmig_phase3_159 - Tmig_phase1_159) + (Tmig_phase3_160 - Tmig_phase1_160) + (Tmig_phase3_161 - Tmig_phase1_161) + (Tmig_phase3_162 - Tmig_phase1_162) + (Tmig_phase3_163 - Tmig_phase1_163) + (Tmig_phase3_164 - Tmig_phase1_164) + (Tmig_phase3_165 - Tmig_phase1_165) + (Tmig_phase3_166 - Tmig_phase1_166) + (Tmig_phase3_167 - Tmig_phase1_167) + (Tmig_phase3_168 - Tmig_phase1_168) + (Tmig_phase3_169 - Tmig_phase1_169) + (Tmig_phase3_170 - Tmig_phase1_170) + (Tmig_phase3_171 - Tmig_phase1_171) + (Tmig_phase3_172 - Tmig_phase1_172) + (Tmig_phase3_173 - Tmig_phase1_173) + (Tmig_phase3_174 - Tmig_phase1_174) + (Tmig_phase3_175 - Tmig_phase1_175) + (Tmig_phase3_176 - Tmig_phase1_176) + (Tmig_phase3_177 - Tmig_phase1_177) + (Tmig_phase3_178 - Tmig_phase1_178) + (Tmig_phase3_179 - Tmig_phase1_179) + (Tmig_phase3_180 - Tmig_phase1_180) + (Tmig_phase3_181 - Tmig_phase1_181) + (Tmig_phase3_182 - Tmig_phase1_182) + (Tmig_phase3_183 - Tmig_phase1_183) + (Tmig_phase3_184 - Tmig_phase1_184) + (Tmig_phase3_185 - Tmig_phase1_185) + (Tmig_phase3_186 - Tmig_phase1_186) + (Tmig_phase3_187 - Tmig_phase1_187) + (Tmig_phase3_188 - Tmig_phase1_188) + (Tmig_phase3_189 - Tmig_phase1_189) + (Tmig_phase3_190 - Tmig_phase1_190) + (Tmig_phase3_191 - Tmig_phase1_191) + (Tmig_phase3_192 - Tmig_phase1_192) + (Tmig_phase3_193 - Tmig_phase1_193) + (Tmig_phase3_194 - Tmig_phase1_194) + (Tmig_phase3_195 - Tmig_phase1_195) + (Tmig_phase3_196 - Tmig_phase1_196) + (Tmig_phase3_197 - Tmig_phase1_197) + (Tmig_phase3_198 - Tmig_phase1_198) + (Tmig_phase3_199 - Tmig_phase1_199) + (Tmig_phase3_200 - Tmig_phase1_200) + (Tmig_phase3_201 - Tmig_phase1_201) + (Tmig_phase3_202 - Tmig_phase1_202))) * `phase3_migrants_remittance')))
gen beta = r(estimate)
gen se = r(se)
gen true_beta = 0
gen seed = "`i'"
keep beta se true_beta seed
keep in 1
	
* Append to beta dataset
append using `all_betas'
save `"`all_betas'"', replace

}

* Save results
use `all_betas', clear
destring seed, replace
gsort -true_beta seed

save "$dirpath_out/RESULTS_permutation_inference.dta", replace



